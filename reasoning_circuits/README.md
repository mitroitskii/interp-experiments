Work in progress. Will clean up soon.
